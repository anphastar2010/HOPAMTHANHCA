<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>Song Editor ‚Äì H·ª£p √Çm Th·ªù Ph∆∞·ª£ng</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
body {
  font-family: system-ui, sans-serif;
  max-width: 900px;
  margin: auto;
  padding: 16px;
}
h1 { text-align: center; }
h2 { margin-top: 28px; }
input, textarea, select, button {
  width: 100%;
  padding: 10px;
  font-size: 16px;
  margin-bottom: 12px;
}
textarea {
  min-height: 200px;
  font-family: monospace;
}
button {
  background: #1976d2;
  color: white;
  border: none;
  border-radius: 6px;
}
.secondary {
  background: #616161;
}
.song-item {
  border-bottom: 1px solid #ddd;
  padding: 8px;
  cursor: pointer;
}
.song-item:hover {
  background: #eee;
}
.flex {
  display: flex;
  gap: 8px;
}
.flex button {
  flex: 1;
}
pre {
  background: #f5f5f5;
  padding: 12px;
  white-space: pre-wrap;
  border-radius: 6px;
  max-height: 300px;
  overflow: auto;
}
.note {
  font-size: 14px;
  color: #555;
}
</style>
</head>
<body>

<h1>üé∂ Song Editor</h1>

<p class="note">
‚úèÔ∏è Nh·∫≠p l·ªùi + h·ª£p √¢m d·∫°ng <code>[C]</code><br>
üîÑ Import <code>songs.js</code> c≈© ƒë·ªÉ s·ª≠a ti·∫øp<br>
üì¶ Xu·∫•t <code>songs.js</code> d√πng ngay cho app
</p>

<hr>

<h2>0Ô∏è‚É£ IMPORT songs.js C≈®</h2>

<textarea id="importInput" placeholder="D√°n to√†n b·ªô n·ªôi dung file songs.js v√†o ƒë√¢y"></textarea>
<button class="secondary" onclick="importSongs()">üîÑ Import songs.js</button>

<hr>

<h2>1Ô∏è‚É£ NH·∫¨P / S·ª¨A B√ÄI H√ÅT</h2>

<input id="title" placeholder="T√™n b√†i h√°t" />
<input id="artist" placeholder="T√°c gi·∫£ / Ngu·ªìn (tu·ª≥ ch·ªçn)" />

<select id="key">
  <option value="">Gi·ªçng g·ªëc</option>
  <option>C</option><option>D</option><option>E</option>
  <option>F</option><option>G</option><option>A</option><option>B</option>
</select>

<textarea id="content" placeholder="V√≠ d·ª•:
[C]L·∫°y Ch√∫a con ƒë·∫øn
[Am]Tr∆∞·ªõc ngai vinh hi·ªÉn
[F]L√≤ng con th·ªù [G]l·∫°y Ng√†i"></textarea>

<div class="flex">
  <button onclick="addOrUpdateSong()">‚ûï Th√™m / C·∫≠p nh·∫≠t</button>
  <button class="secondary" onclick="clearForm()">üßπ Xo√° form</button>
</div>

<hr>

<h2>2Ô∏è‚É£ DANH S√ÅCH B√ÄI H√ÅT</h2>
<div id="songList"></div>

<hr>

<h2>3Ô∏è‚É£ XU·∫§T FILE <code>songs.js</code></h2>
<button onclick="exportSongs()">‚¨áÔ∏è T·∫£i songs.js</button>

<pre id="preview"></pre>

<script>
/* ===============================
   DATA
================================ */
let songs = [];

/* ===============================
   IMPORT songs.js
================================ */
function importSongs() {
  const text = document.getElementById("importInput").value.trim();

  if (!text.includes("const songs")) {
    alert("‚ö†Ô∏è Kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng songs.js");
    return;
  }

  try {
    const arrayText = text
      .replace(/^[\s\S]*?const songs\s*=\s*/, "")
      .replace(/;?\s*$/, "");

    // ‚ö†Ô∏è eval ch·ªâ d√πng local, do ch√≠nh b·∫°n d√°n
    const imported = eval(arrayText);

    if (!Array.isArray(imported)) throw new Error();

    songs = imported.map(s => ({
      id: s.id || Date.now(),
      title: s.title || "",
      artist: s.artist || "",
      key: s.key || "C",
      content: s.content || ""
    }));

    renderList();
    renderPreview();
    alert("‚úÖ Import th√†nh c√¥ng: " + songs.length + " b√†i");

  } catch {
    alert("‚ùå Kh√¥ng th·ªÉ import. Ki·ªÉm tra l·∫°i n·ªôi dung songs.js");
  }
}

/* ===============================
   CRUD
================================ */
function addOrUpdateSong() {
  const title = titleEl.value.trim();
  const artist = artistEl.value.trim();
  const key = keyEl.value;
  const content = contentEl.value.trim();

  if (!title || !key || !content) {
    alert("‚ö†Ô∏è Vui l√≤ng nh·∫≠p T√™n ‚Äì Gi·ªçng ‚Äì N·ªôi dung");
    return;
  }

  const existing = songs.find(s => s.title === title);

  if (existing) {
    existing.artist = artist;
    existing.key = key;
    existing.content = content;
  } else {
    songs.push({
      id: Date.now(),
      title,
      artist,
      key,
      content
    });
  }

  renderList();
  renderPreview();
}

function renderList() {
  const list = document.getElementById("songList");
  list.innerHTML = "";

  songs.forEach(song => {
    const div = document.createElement("div");
    div.className = "song-item";
    div.textContent = song.title;
    div.onclick = () => loadSong(song);
    list.appendChild(div);
  });
}

function loadSong(song) {
  titleEl.value = song.title;
  artistEl.value = song.artist;
  keyEl.value = song.key;
  contentEl.value = song.content;
}

function clearForm() {
  titleEl.value = "";
  artistEl.value = "";
  keyEl.value = "";
  contentEl.value = "";
}

/* ===============================
   EXPORT songs.js
================================ */
function exportSongs() {
  const text =
`const songs = [
${songs.map(s => `
{
  id: ${s.id},
  title: "${s.title.replace(/"/g, '\\"')}",
  artist: "${s.artist.replace(/"/g, '\\"')}",
  key: "${s.key}",
  content: \`
${s.content}
  \`
}`).join(",\n")}
];`;

  const blob = new Blob([text], { type: "application/javascript" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "songs.js";
  a.click();

  renderPreview(text);
}

function renderPreview(text = "") {
  document.getElementById("preview").textContent = text;
}

/* ===============================
   ELEMENTS
================================ */
const titleEl = document.getElementById("title");
const artistEl = document.getElementById("artist");
const keyEl = document.getElementById("key");
const contentEl = document.getElementById("content");
</script>

</body>
</html>
